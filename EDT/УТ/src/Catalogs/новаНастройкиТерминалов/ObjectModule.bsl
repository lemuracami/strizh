
//**** Обработчики событий объекта ****//

//Синхронизация с КСЛ
//
Процедура ПриЗаписи(Отказ)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;	
	
	Если Основные Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|    Ссылка
		|  ИЗ
		|    Справочник.новаНастройкиТерминалов
		|  ГДЕ
		|    Ссылка <> &Ссылка
		|    И Основные
		|");
		
		Запрос.УстановитьПараметр("Ссылка", Ссылка);
		
		РезультатЗапроса = Запрос.Выполнить();
		Если не РезультатЗапроса.Пустой() Тогда
			
			Выборка = РезультатЗапроса.Выбрать();
			Пока Выборка.Следующий() Цикл
				
				обНастройки = Выборка.Ссылка.ПолучитьОбъект();
				обНастройки.Основные = Ложь;
				обНастройки.Записать();
			КонецЦикла;
		КонецЕсли;
	КонецЕсли;
	
	Попытка
		новаОбменКСЛ.СохранитьНастройкиТерминала(ЭтотОбъект);
	Исключение
		#Если Клиент Тогда			
			новаОбщиеПроцедуры.СообщитьПользователюОбОшибке("ВнутренняОшибкаСервера", ОписаниеОшибки());
		#КонецЕсли
		Отказ = Истина;
	КонецПопытки;
	
КонецПроцедуры

//Синхронизация с КСЛ
//
Процедура ПередУдалением(Отказ)
	
	Попытка
		новаОбменКСЛ.УдалитьНастройкиТерминала(ЭтотОбъект);
	Исключение
		#Если Клиент Тогда			
			новаОбщиеПроцедуры.СообщитьПользователюОбОшибке("ВнутренняОшибкаСервера", ОписаниеОшибки());
		#КонецЕсли
		Отказ = Истина;
	КонецПопытки;
	
КонецПроцедуры
