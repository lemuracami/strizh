
&НаКлиенте
Процедура Заполнить(Команда)
	//Если Элементы.Список.ТекущаяСтрока <> Неопределено Тогда
	//	Зап = Новый Запрос;
	//	Зап.Текст = "ВЫБРАТЬ
	//	|	ПриходДСПоОтчетуВодителя.Ссылка КАК Док
	//	|ИЗ
	//	|	Документ.ВозвратЗаказовОтВодителя КАК ПриходДСПоОтчетуВодителя
	//	|ГДЕ
	//	|	ПриходДСПоОтчетуВодителя.ОтчетВодителя.Ссылка = &ОтчетВодителя";
	//	Зап.УстановитьПараметр("ОтчетВодителя", Элементы.Список.ТекущаяСтрока.Ссылка);
	//	Рез = зап.Выполнить();
	//	Выб = Рез.Выбрать();
	//	если Выб.Следующий() Тогда
	//		Д = Новый Структура("Ключ", Выб.Док);
	//		Форма = ПолучитьФорму("Документ.ВозвратЗаказовОтВодителя.Форма.ФормаДокумента", Д);
	//	Иначе
	//		Форма = ПолучитьФорму("Документ.ВозвратЗаказовОтВодителя.Форма.ФормаДокумента");
	//	КонецеСли;	
	//	Форма.Открыть();
	//	если Форма.Объект.Доставки.Количество() = 0 Тогда
	//		Форма.Объект.ОтчетВодителя = Элементы.Список.ТекущаяСтрока.Ссылка;
	//	КонецеСли;	
	//КонецЕСли;	
КонецПроцедуры

&НаКлиенте
Процедура СписокВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	//Если Элементы.Список.ТекущаяСтрока <> Неопределено Тогда
	//	Зап = Новый Запрос;
	//	Зап.Текст = "ВЫБРАТЬ
	//	|	ПриходДСПоОтчетуВодителя.Ссылка КАК Док
	//	|ИЗ
	//	|	Документ.ВозвратЗаказовОтВодителя КАК ПриходДСПоОтчетуВодителя
	//	|ГДЕ
	//	|	ПриходДСПоОтчетуВодителя.ОтчетВодителя.Ссылка = &ОтчетВодителя";
	//	Зап.УстановитьПараметр("ОтчетВодителя", Элементы.Список.ТекущаяСтрока.Ссылка);
	//	Рез = зап.Выполнить();
	//	Выб = Рез.Выбрать();
	//	если Выб.Следующий() Тогда
	//		Д = Новый Структура("Ключ", Выб.Док);
	//		Форма = ПолучитьФорму("Документ.ВозвратЗаказовОтВодителя.Форма.ФормаДокумента", Д);
	//		Форма.Открыть();
	//	КонецеСли;	
	//КонецЕСли;	
КонецПроцедуры

&НаКлиенте
Процедура ПечатьАкта(Команда)
	Если Элементы.Список.ТекущаяСтрока <> Неопределено Тогда
		Обр = Обработки.АктПриемаПередачиТоваров.Создать();
		Обр.ОтчетВодителя = Элементы.Список.ТекущаяСтрока.Ссылка;
		Обр.Печать();
	КонецеСли;	 
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ТекПользователь = ПараметрыСеанса.ТекущийПользователь;
	Запрос = Новый Запрос("ВЫБРАТЬ
	                      |	НастройкиПользователей.Пользователь КАК Пользователь,
	                      |	НастройкиПользователей.Настройка КАК Настройка,
	                      |	НастройкиПользователей.Значение КАК Значение
	                      |ИЗ
	                      |	РегистрСведений.НастройкиПользователей КАК НастройкиПользователей
	                      |ГДЕ
	                      |	НастройкиПользователей.Пользователь = &Пользователь
	                      |	И НастройкиПользователей.Настройка = &Настройка");
	Запрос.УстановитьПараметр("Пользователь", ТекПользователь);
	Запрос.УстановитьПараметр("Настройка", ПланыВидовХарактеристик.НастройкиПользователей.ТерминалДоставки);
	Рез = Запрос.Выполнить().Выбрать();
	//ТерминалСпис = Новый СписокЗначений;
	ТерминалСпис = Новый Массив;
	
	Если Рез.Следующий() Тогда		
		Если Рез.Значение = Справочники.РегиональныеТерминалы.МоскваСтриж Тогда
			ТерминалСпис.Добавить(Справочники.РегиональныеТерминалы.МоскваСтриж);
			ТерминалСпис.Добавить(Справочники.РегиональныеТерминалы.ПустаяСсылка());
		ИначеЕсли Рез.Значение = Справочники.РегиональныеТерминалы.СПбСтриж Тогда
			ТерминалСпис.Добавить(Справочники.РегиональныеТерминалы.СПбСтриж);
		Иначе
			ТерминалСпис.Добавить(Справочники.РегиональныеТерминалы.МоскваСтриж);
			ТерминалСпис.Добавить(Справочники.РегиональныеТерминалы.СПбСтриж);
			ТерминалСпис.Добавить(Справочники.РегиональныеТерминалы.ПустаяСсылка());
		КонецЕсли;	
	Иначе		
		ТерминалСпис.Добавить(Справочники.РегиональныеТерминалы.МоскваСтриж);
		ТерминалСпис.Добавить(Справочники.РегиональныеТерминалы.СПбСтриж);
		ТерминалСпис.Добавить(Справочники.РегиональныеТерминалы.ПустаяСсылка());	
	КонецЕсли;
	
	Список.Параметры.УстановитьЗначениеПараметра("ТерминалДоставки", ТерминалСпис);
	
КонецПроцедуры
