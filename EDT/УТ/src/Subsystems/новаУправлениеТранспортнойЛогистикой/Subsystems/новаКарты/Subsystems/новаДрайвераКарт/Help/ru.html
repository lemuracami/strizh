<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link href="v8help://service_book/service_style" type="text/css" rel="stylesheet"></link><meta content="MSHTML 6.00.6000.21264" name="GENERATOR"></meta></head><body>
<h1 class="">Внешняя компонента для отображения карт.</h1>
<p class=""> </p>
<p class="">Для отображения карт используется элемент управления ActiveX. Элемент управления имеет ProgID "MapsContainer.CMapsContainer.1".</p>
<h2 class="">Свойства:</h2>
<h3 class="">
<hr></hr>
CurrentMap [in, out] LONG (число)</h3>
<p class="">Содержит индекс текущей видимой карты. Значение индекса возвращается при добавлении карты методом AddMap().</p>
<h3 class="">
<hr></hr>
CurrentMapObject [out] IDispatch * (COMОбъект)</h3>
<p class="">Содержит COM-объект текущей карты.</p>
<h3 class="">
<hr></hr>
Version [out] BSTR (строка)</h3>
<p class="">Содержит текущую версию элемента управления. Используется для автоматического обновления компонента вместе с конфигурацией.</p>
<h2 class=""> </h2>
<h2 class="">Методы:</h2>
<h3 class="">
<hr></hr>
AddMap</h3>
<p class="">Добавляет карту.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) MapType</h4>
<p class="">Тип карты. 0 - карта CityGuide, 2 - карта Ингит.</p>
<h4 class="">[in] BSTR (строка) MapProgID</h4>
<p class="">ProgID добавляемой карты.</p>
<h4 class="">[in] IUnknown (ОбработкаОбъект) *External</h4>
<p class="">Драйвер карты. Объект 1С, обрабатывающий события карты.</p>
<h4 class="">[in,out] LONG (число) *MapIndex</h4>
<p class="">Переменная, куда после вызова метода будет сохранен индекс карты.</p>
<h3 class="">
<hr></hr>
Refresh</h3>
<p class="">Перерисовывает карту.</p>
<h3 class="">
<hr></hr>
DeleteMaps</h3>
<p class="">Удаляет все ранее добавленные карты.</p>
<h3 class="">
<hr></hr>
SetLayer</h3>
<p class="">Устанавливает текущий слой отображения, для последующего добавления объектов.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) id</h4>
<p class="">Идентификатор слоя.</p>
<h3 class="">
<hr></hr>
SetObject</h3>
<p class="">Устанавливает текущий объект, для последующего добавления примитивов и установки свойств. Ранее добавленные примитивы очищаются.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) id</h4>
<p class="">Идентификатор объекта.</p>
<h3 class="">
<hr></hr>
AddPrimitive</h3>
<p class="">Добавляет примитив к текущему объекту.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) Kind</h4>
<p class="">Вид примитива.</p>
<h3 class="">
<hr></hr>
PushLatLon</h3>
<p class="">Устанавливает географические координаты последнего добавленного примитива. Если примитив требует указания координат нескольких точек, то метод следует вызывать требуемое количество раз.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] DOUBLE (число) Lat</h4>
<p class="">Широта в градусах.</p>
<h4 class="">[in] DOUBLE Lon</h4>
<p class="">Долгота в градусах.</p>
<h3 class="">
<hr></hr>
PushNumber</h3>
<p class="">Устанавливает числовой параметр последнего добавленного примитива. Если примитив имеет несколько числовых параметров, то метод следует вызывать требуемое количество раз.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] DOUBLE (число) num</h4>
<p class="">Значение параметра.</p>
<h3 class="">
<hr></hr>
PushString</h3>
<p class="">Устанавливает строковый параметр последнего добавленного примитива. Если примитив имеет несколько строковых параметров, то метод следует вызывать требуемое количество раз.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] BSTR (строка) str</h4>
<p class="">Значение параметра.</p>
<h3 class="">
<hr></hr>
PushFlags</h3>
<p class="">Устанавливает флаги последнего добавленного примитива.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) NewFlags</h4>
<p class="">Значение флагов.</p>
<h3 class="">
<hr></hr>
SetScreenFrame</h3>
<p class="">Устанавливает соответствие между экранными координатами и географическими, для отображения объектов на карте. Передаются координаты левого вернего и правого нижнего углов отображаемой области.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] DOUBLE (число) Lat1</h4>
<p class="">Широта верхнего левого угла.</p>
<h4 class="">[in] DOUBLE (число) Lon1</h4>
<p class="">Долгота верхнего левого угла.</p>
<h4 class="">[in] LONG (число) X1</h4>
<p class="">Верхний левый угол, координата X.</p>
<h4 class="">[in] LONG (число) Y1</h4>
<p class="">Верхний левый угол, координата Y.</p>
<h4 class="">
<h4 class="">[in] DOUBLE (число) Lat2</h4></h4>
<p class="">Широта правого нижнего угла.</p>
<h4 class="">
<h4 class="">[in] DOUBLE (число) Lon2</h4></h4>
<p class="">Долгота правого нижнего угла.</p>
<h4 class="">
<h4 class="">[in] LONG (число) X2</h4></h4>
<p class="">Правый нижний угол, координата X.</p>
<h4 class="">
<h4 class="">[in] LONG (число) Y2</h4></h4>
<p class="">Правый нижний угол, координата Y.</p>
<h3 class="">
<hr></hr>
GetStyleDefinition</h3>
<p class="">Возвращает стили отображения на карте, заданные по-умолчанию. За один вызов возвращает описание одного стиля; для получения всех стилей следует вызывать до тех пор, пока метод не возвратит в качестве идентификатора стиля 0.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[out] LONG (число) *Id</h4>
<p class="">Переменная, куда будет помещен идентификатор стиля.</p>
<h4 class="">[out] LONG (число) *Parent</h4>
<p class="">Переменная, куда будет помещен идентификатор родителя стиля.</p>
<h4 class="">[out] BSTR (строка) *Name</h4>
<p class="">Переменная, куда будет помещено название стиля.</p>
<h4 class="">[out] BSTR (строка) *Type</h4>
<p class="">Переменная, куда будет помещен тип стиля.</p>
<h4 class="">[out] BSTR (строка) *DefaultString</h4>
<p class="">Переменная, куда будет помещено строковое значение стиля.</p>
<h4 class="">[out] LONG (число) *DefaultInteger</h4>
<p class="">Переменная, куда будет помещено числовое значение стиля.</p>
<h3 class="">
<hr></hr>
SetStyle</h3>
<p class="">Устанавливает текущий набор стилей. В дальнейшем, каждому добавлямому примитиву будет назначен этот набор стилей.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) StyleSheetId</h4>
<p class="">Идентификатор набора стилей. Наборы стилей должны быть предварительно созданы вызовами метода SetStyleValue().</p>
<h3 class="">
<hr></hr>
SetStyleValue</h3>
<p class="">Устанавливает значение стиля из заданного набора стилей и создает новый набор стилей при необходимости.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) StyleSheetId</h4>
<p class="">Идентификатор набора стилей.</p>
<h4 class="">[in] LONG (число) StyleId</h4>
<p class="">Идентификатор стиля.</p>
<h4 class="">[in] ULONG (число) Value</h4>
<p class="">Значение стиля.</p>
<h3 class="">
<hr></hr>
ShowLayer</h3>
<p class="">Устанавливает видимость всех объектов заданного слоя.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) id</h4>
<p class="">Идентификатор слоя.</p>
<h4 class="">[in] LONG (число) NewVisible</h4>
<p class="">Флаг видимости слоя, 1-видимый, 0-невидимый.</p>
<h3 class="">
<hr></hr>
ShowObject</h3>
<p class="">Устанавливает видимость объекта.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) id</h4>
<p class="">Идентификатор объекта.</p>
<h4 class="">[in] LONG (число) NewVisible</h4>
<p class="">Флаг видимости объекта, 1-видимый, 0-невидимый.</p>
<h4 class="">[in] LONG (число) NewAlpha</h4>
<p class="">Степень прозрачности объекта. 128-пунктир, 255-сплошной.</p>
<h3 class="">
<hr></hr>
SetExternal</h3>
<p class="">Устанавливает объект 1С - обработчик событий объектов карты.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in]IUnknown (ОбработкаОбъект) *External</h4>
<p class="">Экземпляр обработки новаМенеджерКарт.</p>
<h3 class="">
<hr></hr>
SetCursorPos</h3>
<p class="">Устанавливает курсор мыши в заданную точку окна карты.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) x</h4>
<p class="">Координата X.</p>
<h4 class="">[in] LONG (число) y</h4>
<p class="">Координата Y.</p>
<h3 class=""> </h3>
<h2 class="">Методы для работы с картами Ингит.</h2>
<p class="">Многие методы карты Ингит возвращают параметры по ссылке. Поскольку платформа 1С не поддреживает такую передачу для IDispatch, переданных в 1С, для нужных методов созданы обертки.</p>
<p class="">
</p><hr></hr><p></p>
<p class="">Ingit_getMapInfo</p>
<p class="">Возвращает информацию о карте Ингит.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) Map</h4>
<p class="">Индекс карты.</p>
<h3 class="">Возвращаемое значение:</h3>
<h4 class="">COMSafeArray[3]</h4>
<p class="">Массив параметров карты:<br>0 - тип карты;<br>1 - исходный масштаб карты;<br>2 - географическая рамка.</p>
<h3 class="">
<hr></hr>
Ingit_Dev2Geo</h3>
<p class="">Возвращает географические координаты точки на экране, для карты Ингит.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) Map</h4>
<p class="">Индекс карты.</p>
<h4 class="">[in] LONG (число) x</h4>
<p class="">Координата X.</p>
<h4 class="">[in] LONG (число) y</h4>
<p class="">Координата Y.</p>
<h3 class="">Возвращаемое значение:</h3>
<h4 class="">COMSafeArray[2]</h4>
<p class="">Массив координат:<br>0 - широта;<br>1 - долгота.<br></p>
<h3 class="">
<hr></hr>
Ingit_SearchAddress</h3>
<p class="">Геокодирует адрес по карте Ингит.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) Map</h4>
<p class="">Индекс карты.</p>
<h4 class="">[in] BSTR (строка) Address</h4>
<p class="">Адрес в виде строки.</p>
<h3 class="">Возвращаемое значение:</h3>
<h4 class="">COMSafeArray[3]</h4>
<p class="">Массив параметров точки:<br>0 - Истина, если геокодирование успешно;<br>1 - широта;<br>2 - долгота.</p>
<h3 class="">
<hr></hr>
Ingit_Geo2Dev</h3>
<p class="">Возвращает экранные координаты точки по географическим, для карты Ингит.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) Map</h4>
<p class="">Индекс карты.</p>
<h4 class="">
<h4 class="">[in] DOUBLE (число) Lat</h4></h4>
<p class="">Широта верхнего левого угла.</p>
<h4 class="">
<h4 class="">[in] DOUBLE (число) Lon</h4></h4>
<p class="">Долгота верхнего левого угла.</p>
<h4 class="">Возвращаемое значение:</h4>
<h4 class="">COMSafeArray[2]</h4>
<p class="">Массив координат точки:<br>0 - X;<br>1 - Y.</p>
<h3 class="">
<hr></hr>
Ingit_GetGeoCenter</h3>
<p class="">Возвращает текущие координаты центра карты, для карты Ингит.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) Map</h4>
<p class="">Индекс карты.</p>
<h3 class="">Возвращаемое значение:</h3>
<h4 class="">COMSafeArray[2]</h4>
<p class="">Массив координат:<br>0 - широта;<br>1 - долгота.</p>
<h3 class="">
<hr></hr>
Ingit_getMeasure</h3>
<p class="">Возвращает расстояние между точками, для карты Ингит.</p>
<h3 class="">Параметры:</h3>
<h4 class="">[in] LONG (число) Map</h4>
<p class="">Индекс карты.</p>
<h4 class="">
<h4 class="">[in] DOUBLE (число) Lat1</h4></h4>
<p class="">Широта первой точки.</p>
<h4 class="">
<h4 class="">[in] DOUBLE (число) Lon1</h4></h4>
<p class="">Долгота первой точки.</p>
<h4 class="">
<h4 class="">[in] DOUBLE (число) Lat2</h4></h4>
<p class="">Широта второй точки.</p>
<h4 class="">
<h4 class="">[in] DOUBLE (число) Lon2</h4></h4>
<p class="">Долгота второй точки.</p>
<h3 class="">Возвращаемое значение:</h3>
<h4 class="">DOUBLE (число)</h4>
<p class="">Расстояние между точками.<br></p></body></html>