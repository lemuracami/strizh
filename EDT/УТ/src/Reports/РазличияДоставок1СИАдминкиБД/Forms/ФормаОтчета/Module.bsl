
&НаКлиенте
Процедура ОтправитьПоПочте(Команда)
	 ОтправитьПоПочтеНАСервере();
КонецПроцедуры

Процедура ОтправитьПоПочтеНАСервере()
	Об = РеквизитФормыВЗначение("Отчет");
	Результат = Об.СформироватьОтправитьПоПочте(Отчет.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы[0].Значение);
	Если Результат.ВысотаТаблицы > 4 Тогда
		
		Г = Новый УникальныйИдентификатор;
		ПутьКФайлу = КаталогВременныхФайлов() + Строка(Г) + ".html";
		Результат.Записать(ПутьКФайлу, ТипФайлаТабличногоДокумента.HTML3);
		Т = Новый ТекстовыйДокумент();
		Т.Прочитать(ПутьКФайлу);
		Стр = Т.ПолучитьТекст();
		МасП = Новый Массив;
		
		//МасП.Добавить("pavel.nechaev@strizh-logistic.ru");
		//МасП.Добавить("logist@strizh-logistic.ru");
		МасП.Добавить("evgeniy.marochkin@strizh-logistic.ru");
		
		Отпр = lem.ОтправитьСообщение(МасП, "Отчет по различиям на " + Формат(Отчет.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы[0].Значение, "ДЛФ=DD"), Стр, , "Логистическая компания ""Стриж""",, ТипТекстаПочтовогоСообщения.HTML) ;
	Иначе
		
	КонецеСли;
КонецПроцедуры	

